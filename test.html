<html>
<head>
<script src="SampleBank.js"></script>
<script src="WebDirt.js"></script>
<script src="Graph.js"></script>
<script>
var webDirt;

function onload() {
  webDirt = new WebDirt();
}

WebDirt.prototype.testWebAudioIsWorking = function() {
  var sine = this.ac.createOscillator();
	sine.type = 'sine';
	sine.frequency.value = 440;
	var gain = this.ac.createGain();
	sine.connect(gain);
	gain.connect(this.ac.destination);
	sine.start();
	// envelope
	var now = this.ac.currentTime;
	gain.gain.setValueAtTime(0,now);
  gain.gain.linearRampToValueAtTime(amp,now+0.005);
  gain.gain.linearRampToValueAtTime(0,now+0.405);
}

WebDirt.prototype.testSampleBankGetsBuffer = function() {
  var source = this.ac.createBufferSource();
  source.buffer = this.sampleBank.getBuffer('cp/HANDCLP0.wav');
  source.connect(this.ac.destination);
  var soon = this.ac.currentTime+0.1;
  source.start(soon);
}

WebDirt.prototype.testPlaybackOfSimpleMessage = function(){
  // var source = this.ac.createBufferSource();
  // source.buffer = this.sampleBank.getBuffer('cp/HANDCLP0.wav');
  // source.connect(this.ac.destination);

  var msg = {
    sample_name: "cp/HANDCLP0.wav",
    when:0
  }

  queue(msg)

}

</script>
</head>
<body onload="onload()">
  <div>WebDirt test page</div>
  <button onclick="webDirt.testWebAudioIsWorking()">testWebAudioIsWorking</button>
  <button onclick="webDirt.testSampleBankGetsBuffer()">testSampleBankGetsBuffer</button>
  <button onclick="webDirt.testPlaybackOfSimpleMessage()">testPlaybackOfSimpleMessage</button>
</body>
</html>
